{% extends "base.html" %}
{% block content %}

<div class="actions">
  <form action="/scan" method="post" style="display:inline;">
    <input type="text" name="url" placeholder="Enter target URL..." class="input-url" required>
    <button type="submit" class="btn btn-red">New Scan</button>
  </form>
  <button class="btn btn-gray" onclick="window.location.reload()">Generate Report</button>
</div>

<table class="scan-table">
  <thead>
    <tr>
      <th>Target</th>
      <th>Total</th>
      <th>High</th>
      <th>Medium</th>
      <th>Low</th>
      <th>Last Run</th>
      <th>Status</th>
      <th>Report</th>
    </tr>
  </thead>
  <tbody>
    {% if reports %}
      {% for r in reports %}
      <tr>
        <td>{{ r.target }}</td>
        <td>{{ r.total }}</td>
        <td><span class="badge high">{{ r.high }}</span></td>
        <td><span class="badge medium">{{ r.medium }}</span></td>
        <td><span class="badge low">{{ r.low }}</span></td>
        <td>{{ r.date }}</td>
        <td>
          {% if r.status == "Completed" %}
            <span class="status completed">Completed</span>
          {% else %}
            <span class="status progress">In Progress</span>
          {% endif %}
        </td>
        <td>
          {% if r.status == "Completed" %}
            <a href="/report/{{ r.file }}" class="btn btn-blue">View</a>
          {% else %}
            <button class="btn btn-gray" disabled>Pending</button>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    {% else %}
      <tr><td colspan="8" style="text-align:center;">No reports available</td></tr>
    {% endif %}
  </tbody>
</table>

{% endblock %}
